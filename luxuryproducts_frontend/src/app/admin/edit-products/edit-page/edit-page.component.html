@if (product()) {
    <div class="product-detail-container">
        @for (name of variationNames(); track name) {
            <div class="variation-group">
                <span class="variation-label">{{ name }}:</span>
                <div class="variation-buttons">
                    @for (option of getFilteredOptions(name); track option) {
                        <button
                            (click)="onSelectValue(name, option)"
                            [class.selected]="selectedValues[name] === option"
                            type="button"
                        >
                            {{ option }}
                        </button>
                    }
                </div>
            </div>
        }

        @if (selectedVariation && selectedVariation.stock >= 0) {
            <div class="product-display">
                <img
                    [src]="selectedVariation.imageUrl"
                    [alt]="selectedVariation.sku"
                    class="product-image"
                />

                <div class="product-info">
                    <label>
                        {{ 'admin.price' | translate }} (€):
                        <input
                            type="number"
                            [(ngModel)]="selectedVariation.price"
                            step="0.01"
                        />
                    </label>

                    <label>
                        {{ 'admin.stock' | translate }}
                        <input type="number" [(ngModel)]="selectedVariation.stock" />
                    </label>

                    <label>
                        Image URL:
                        <input type="text" [(ngModel)]="selectedVariation.imageUrl" />
                    </label>

                    @for (val of selectedVariation.values; track val) {
                        <div>
                            <label>
                                {{ val.variation.variationName }}:
                                <input [(ngModel)]="val.value" />
                            </label>
                        </div>
                    }

                    <button class="save-var-btn" (click)="saveVariationChanges()">Save</button>
                    <button class="delete-var-btn" (click)="deleteVariation(selectedVariation!.productVariationId)">
                        {{ 'admin.del-var' | translate }}
                    </button>
                </div>
            </div>
        }

        <hr />

        <button (click)="toggleCreateForm()" type="button">
            {{ showCreateForm ? 'Cancel' : 'Create New Variant' }}
        </button>

        @if (showCreateForm) {
            <div class="new-variation-form">
                <h3>{{ 'admin.new-var' | translate }}</h3>

                <label>
                    SKU:
                    <input type="text" [(ngModel)]="newVariation.sku" />
                </label>

                <label>
                    {{ 'admin.price' | translate }} (€):
                    <input type="number" [(ngModel)]="newVariation.price" step="0.01" />
                </label>

                <label>
                    {{ 'admin.stock' | translate }}
                    <input type="number" [(ngModel)]="newVariation.stock" />
                </label>

                <label>
                    Image URL:
                    <input type="text" [(ngModel)]="newVariation.imageUrl" />
                </label>

                @for (val of newVariation.values; track val; let i = $index) {
                    <div>
                        <label>
                            {{ 'admin.var-name' | translate }}
                            <input [(ngModel)]="val.variation.variationName" />
                        </label>

                        <label>
                            {{ 'admin.var-value' | translate }}
                            <input [(ngModel)]="val.value" />
                        </label>

                        <button (click)="removeVariationField(i)" type="button">
                            {{ 'admin.rem-field' | translate }}
                        </button>
                    </div>
                }

                <button (click)="addVariationField()" type="button">
                    {{ 'admin.add-field' | translate }}
                </button>

                <br />
                <button class="create-var-btn" (click)="createVariation()" type="button">Create Variant</button>
            </div>
        }
    </div>
}